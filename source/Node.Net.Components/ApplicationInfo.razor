@namespace Node.Net.Components
@using Microsoft.FluentUI.AspNetCore.Components
@using Node.Net.Service.Application
@inject IApplication ApplicationService

@* 
    ApplicationInfo Component
    
    A reusable Razor component that displays application information including:
    - Application Name
    - Company Name
    - Application Data Directory
    - Target Framework
    - Executing Assembly Filename
    - Version
    
    The component retrieves this information from the IApplication service.
    If metadata is missing, appropriate fallback text is displayed.
*@

<FluentCard Style="padding: 1rem;">
    <FluentStack Orientation="Orientation.Vertical" Gap="1rem">
        <h3>Application Information</h3>
        
        <FluentStack Orientation="Orientation.Horizontal" Wrap="true" Gap="1.5rem">
            @* Application Name *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Application:</strong> @(_applicationInfo?.Name ?? "Not available")</div>
            </FluentStack>
            
            @* Company Name *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Company:</strong> @(_applicationInfo?.Company ?? "Not available")</div>
            </FluentStack>
            
            @* Application Data Directory *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Data Directory:</strong> @((_applicationInfo?.DataDirectory == string.Empty || _applicationInfo?.DataDirectory == null) ? "Not available" : _applicationInfo.DataDirectory)</div>
            </FluentStack>
            
            @* Target Framework *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Target Framework:</strong> @((_applicationInfo?.TargetFramework == "unknown" || _applicationInfo?.TargetFramework == null) ? "Not available" : _applicationInfo.TargetFramework)</div>
            </FluentStack>
            
            @* Executing Assembly Filename *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Executing Assembly:</strong> @((_applicationInfo?.ExecutingAssemblyFilename == string.Empty || _applicationInfo?.ExecutingAssemblyFilename == null) ? "Not available" : _applicationInfo.ExecutingAssemblyFilename)</div>
            </FluentStack>
            
            @* Version *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Version:</strong> @((_applicationInfo?.Version == string.Empty || _applicationInfo?.Version == null) ? "Not available" : _applicationInfo.Version)</div>
            </FluentStack>
            
            @* User *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>User:</strong> @((_applicationInfo?.User == string.Empty || _applicationInfo?.User == null) ? "Not available" : _applicationInfo.User)</div>
            </FluentStack>
            
            @* Domain *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Domain:</strong> @((_applicationInfo?.Domain == string.Empty || _applicationInfo?.Domain == null) ? "Not available" : _applicationInfo.Domain)</div>
            </FluentStack>
            
            @* Operating System *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Operating System:</strong> @((_applicationInfo?.OperatingSystem == string.Empty || _applicationInfo?.OperatingSystem == null) ? "Not available" : _applicationInfo.OperatingSystem)</div>
            </FluentStack>
            
            @* Machine *@
            <FluentStack Orientation="Orientation.Vertical" Gap="0.5rem">
                <div><strong>Machine:</strong> @((_applicationInfo?.Machine == string.Empty || _applicationInfo?.Machine == null) ? "Not available" : _applicationInfo.Machine)</div>
            </FluentStack>
        </FluentStack>
    </FluentStack>
</FluentCard>

@code {
    private Node.Net.Service.Application.ApplicationInfo? _applicationInfo;

    protected override void OnInitialized()
    {
        try
        {
            _applicationInfo = ApplicationService.GetApplicationInfo();
        }
        catch (Exception ex)
        {
            Console.Error.WriteLine($"Error retrieving application info: {ex.Message}");
            // Create fallback ApplicationInfo with "Not available" values
            _applicationInfo = new Node.Net.Service.Application.ApplicationInfo(
                "Not available", "Not available", "Not available", "Not available", "Not available", "Not available",
                "Not available", "Not available", "Not available", "Not available");
        }
    }
}
